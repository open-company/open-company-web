shadow$provide.module$node_modules$$sentry$browser$dist$integrations$globalhandlers=function(global,require,module,exports){Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("module$node_modules$tslib$tslib"),core_1=require("module$node_modules$$sentry$core$dist$index"),types_1=require("module$node_modules$$sentry$types$dist$index"),utils_1=require("module$node_modules$$sentry$utils$dist$index"),eventbuilder_1=require("module$node_modules$$sentry$browser$dist$eventbuilder"),
helpers_1=require("module$node_modules$$sentry$browser$dist$helpers");global=function(){function GlobalHandlers(options){this.name=GlobalHandlers.id;this._onUnhandledRejectionHandlerInstalled=this._onErrorHandlerInstalled=!1;this._options=tslib_1.__assign({onerror:!0,onunhandledrejection:!0},options)}GlobalHandlers.prototype.setupOnce=function(){Error.stackTraceLimit=50;this._options.onerror&&(utils_1.logger.log("Global Handler attached: onerror"),this._installGlobalOnErrorHandler());this._options.onunhandledrejection&&
(utils_1.logger.log("Global Handler attached: onunhandledrejection"),this._installGlobalOnUnhandledRejectionHandler())};GlobalHandlers.prototype._installGlobalOnErrorHandler=function(){var _this=this;this._onErrorHandlerInstalled||(utils_1.addInstrumentationHandler({callback:function(data){var error=data.error,currentHub=core_1.getCurrentHub(),hasIntegration=currentHub.getIntegration(GlobalHandlers),isFailedOwnDelivery=error&&!0===error.__sentry_own_request__;!hasIntegration||helpers_1.shouldIgnoreOnError()||
isFailedOwnDelivery||(hasIntegration=currentHub.getClient(),data=utils_1.isPrimitive(error)?_this._eventFromIncompleteOnError(data.msg,data.url,data.line,data.column):_this._enhanceEventWithInitialFrame(eventbuilder_1.eventFromUnknownInput(error,void 0,{attachStacktrace:hasIntegration&&hasIntegration.getOptions().attachStacktrace,rejection:!1}),data.url,data.line,data.column),utils_1.addExceptionMechanism(data,{handled:!1,type:"onerror"}),currentHub.captureEvent(data,{originalException:error}))},
type:"error"}),this._onErrorHandlerInstalled=!0)};GlobalHandlers.prototype._installGlobalOnUnhandledRejectionHandler=function(){var _this=this;this._onUnhandledRejectionHandlerInstalled||(utils_1.addInstrumentationHandler({callback:function(e){var error=e;try{"reason"in e?error=e.reason:"detail"in e&&"reason"in e.detail&&(error=e.detail.reason)}catch(_oO){}e=core_1.getCurrentHub();var hasIntegration=e.getIntegration(GlobalHandlers),isFailedOwnDelivery=error&&!0===error.__sentry_own_request__;if(!hasIntegration||
helpers_1.shouldIgnoreOnError()||isFailedOwnDelivery)return!0;hasIntegration=e.getClient();hasIntegration=utils_1.isPrimitive(error)?_this._eventFromIncompleteRejection(error):eventbuilder_1.eventFromUnknownInput(error,void 0,{attachStacktrace:hasIntegration&&hasIntegration.getOptions().attachStacktrace,rejection:!0});hasIntegration.level=types_1.Severity.Error;utils_1.addExceptionMechanism(hasIntegration,{handled:!1,type:"onunhandledrejection"});e.captureEvent(hasIntegration,{originalException:error})},
type:"unhandledrejection"}),this._onUnhandledRejectionHandlerInstalled=!0)};GlobalHandlers.prototype._eventFromIncompleteOnError=function(msg,url,line,column){var ERROR_TYPES_RE=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/i;msg=utils_1.isErrorEvent(msg)?msg.message:msg;if(utils_1.isString(msg)&&(ERROR_TYPES_RE=msg.match(ERROR_TYPES_RE))){var name=ERROR_TYPES_RE[1];msg=ERROR_TYPES_RE[2]}return this._enhanceEventWithInitialFrame({exception:{values:[{type:name||
"Error",value:msg}]}},url,line,column)};GlobalHandlers.prototype._eventFromIncompleteRejection=function(error){return{exception:{values:[{type:"UnhandledRejection",value:"Non-Error promise rejection captured with value: "+error}]}}};GlobalHandlers.prototype._enhanceEventWithInitialFrame=function(event,url,line,column){event.exception=event.exception||{};event.exception.values=event.exception.values||[];event.exception.values[0]=event.exception.values[0]||{};event.exception.values[0].stacktrace=event.exception.values[0].stacktrace||
{};event.exception.values[0].stacktrace.frames=event.exception.values[0].stacktrace.frames||[];column=isNaN(parseInt(column,10))?void 0:column;line=isNaN(parseInt(line,10))?void 0:line;url=utils_1.isString(url)&&0<url.length?url:utils_1.getLocationHref();0===event.exception.values[0].stacktrace.frames.length&&event.exception.values[0].stacktrace.frames.push({colno:column,filename:url,function:"?",in_app:!0,lineno:line});return event};GlobalHandlers.id="GlobalHandlers";return GlobalHandlers}();exports.GlobalHandlers=
global}
//# sourceMappingURL=module$node_modules$$sentry$browser$dist$integrations$globalhandlers.js.map
