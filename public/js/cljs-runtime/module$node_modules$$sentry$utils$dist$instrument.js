shadow$provide.module$node_modules$$sentry$utils$dist$instrument=function(global,require,module,exports){function triggerHandlers(type,data){var _a;if(type&&handlers[type])try{for(var _b=tslib_1.__values(handlers[type]||[]),_c=_b.next();!_c.done;_c=_b.next()){var handler=_c.value;try{handler(data)}catch(e){logger_1.logger.error("Error while triggering instrumentation handler.\nType: "+type+"\nName: "+misc_1.getFunctionName(handler)+"\nError: "+e)}}}catch(e_1_1){var e_1={error:e_1_1}}finally{try{_c&&
!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error;}}}function instrumentConsole(){"console"in global&&"debug info warn error log assert".split(" ").forEach(function(level){level in global.console&&object_1.fill(global.console,level,function(originalConsoleLevel){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];triggerHandlers("console",{args:args,level:level});originalConsoleLevel&&Function.prototype.apply.call(originalConsoleLevel,global.console,
args)}})})}function instrumentFetch(){supports_1.supportsNativeFetch()&&object_1.fill(global,"fetch",function(originalFetch){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var commonHandlerData={args:args,fetchData:{method:getFetchMethod(args),url:getFetchUrl(args)},startTimestamp:Date.now()};triggerHandlers("fetch",tslib_1.__assign({},commonHandlerData));return originalFetch.apply(global,args).then(function(response){triggerHandlers("fetch",tslib_1.__assign(tslib_1.__assign({},
commonHandlerData),{endTimestamp:Date.now(),response:response}));return response},function(error){triggerHandlers("fetch",tslib_1.__assign(tslib_1.__assign({},commonHandlerData),{endTimestamp:Date.now(),error:error}));throw error;})}})}function getFetchMethod(fetchArgs){void 0===fetchArgs&&(fetchArgs=[]);return"Request"in global&&is_1.isInstanceOf(fetchArgs[0],Request)&&fetchArgs[0].method?String(fetchArgs[0].method).toUpperCase():fetchArgs[1]&&fetchArgs[1].method?String(fetchArgs[1].method).toUpperCase():
"GET"}function getFetchUrl(fetchArgs){void 0===fetchArgs&&(fetchArgs=[]);return"string"===typeof fetchArgs[0]?fetchArgs[0]:"Request"in global&&is_1.isInstanceOf(fetchArgs[0],Request)?fetchArgs[0].url:String(fetchArgs[0])}function instrumentXHR(){if("XMLHttpRequest"in global){var xhrproto=XMLHttpRequest.prototype;object_1.fill(xhrproto,"open",function(originalOpen){return function(){for(var args=[],_i$jscomp$0=0;_i$jscomp$0<arguments.length;_i$jscomp$0++)args[_i$jscomp$0]=arguments[_i$jscomp$0];var xhr=
this;_i$jscomp$0=args[1];xhr.__sentry_xhr__={method:is_1.isString(args[0])?args[0].toUpperCase():args[0],url:args[1]};is_1.isString(_i$jscomp$0)&&"POST"===xhr.__sentry_xhr__.method&&_i$jscomp$0.match(/sentry_key/)&&(xhr.__sentry_own_request__=!0);var onreadystatechangeHandler=function(){if(4===xhr.readyState){try{xhr.__sentry_xhr__&&(xhr.__sentry_xhr__.status_code=xhr.status)}catch(e){}triggerHandlers("xhr",{args:args,endTimestamp:Date.now(),startTimestamp:Date.now(),xhr:xhr})}};"onreadystatechange"in
xhr&&"function"===typeof xhr.onreadystatechange?object_1.fill(xhr,"onreadystatechange",function(original){return function(){for(var readyStateArgs=[],_i=0;_i<arguments.length;_i++)readyStateArgs[_i]=arguments[_i];onreadystatechangeHandler();return original.apply(xhr,readyStateArgs)}}):xhr.addEventListener("readystatechange",onreadystatechangeHandler);return originalOpen.apply(xhr,args)}});object_1.fill(xhrproto,"send",function(originalSend){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=
arguments[_i];triggerHandlers("xhr",{args:args,startTimestamp:Date.now(),xhr:this});return originalSend.apply(this,args)}})}}function instrumentHistory(){function historyReplacementFunction(originalHistoryFunction){return function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var url=2<args.length?args[2]:void 0;url&&(_i=lastHref,lastHref=url=String(url),triggerHandlers("history",{from:_i,to:url}));return originalHistoryFunction.apply(this,args)}}if(supports_1.supportsHistory()){var oldOnPopState=
global.onpopstate;global.onpopstate=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];_i=global.location.href;var from=lastHref;lastHref=_i;triggerHandlers("history",{from:from,to:_i});if(oldOnPopState)return oldOnPopState.apply(this,args)};object_1.fill(global.history,"pushState",historyReplacementFunction);object_1.fill(global.history,"replaceState",historyReplacementFunction)}}function instrumentDOM(){"document"in global&&(global.document.addEventListener("click",
domEventHandler("click",triggerHandlers.bind(null,"dom")),!1),global.document.addEventListener("keypress",keypressEventHandler(triggerHandlers.bind(null,"dom")),!1),["EventTarget","Node"].forEach(function(target){(target=global[target]&&global[target].prototype)&&target.hasOwnProperty&&target.hasOwnProperty("addEventListener")&&(object_1.fill(target,"addEventListener",function(original){return function(eventName,fn,options){fn&&fn.handleEvent?("click"===eventName&&object_1.fill(fn,"handleEvent",function(innerOriginal){return function(event){domEventHandler("click",
triggerHandlers.bind(null,"dom"))(event);return innerOriginal.call(this,event)}}),"keypress"===eventName&&object_1.fill(fn,"handleEvent",function(innerOriginal){return function(event){keypressEventHandler(triggerHandlers.bind(null,"dom"))(event);return innerOriginal.call(this,event)}})):("click"===eventName&&domEventHandler("click",triggerHandlers.bind(null,"dom"),!0)(this),"keypress"===eventName&&keypressEventHandler(triggerHandlers.bind(null,"dom"))(this));return original.call(this,eventName,fn,
options)}}),object_1.fill(target,"removeEventListener",function(original){return function(eventName,fn,options){try{original.call(this,eventName,fn.__sentry_wrapped__,options)}catch(e){}return original.call(this,eventName,fn,options)}}))}))}function domEventHandler(name,handler,debounce){void 0===debounce&&(debounce=!1);return function(event){keypressTimeout=void 0;event&&lastCapturedEvent!==event&&(lastCapturedEvent=event,debounceTimer&&clearTimeout(debounceTimer),debounce?debounceTimer=setTimeout(function(){handler({event:event,
name:name})}):handler({event:event,name:name}))}}function keypressEventHandler(handler){return function(event){try{var target=event.target}catch(e){return}var tagName=target&&target.tagName;tagName&&("INPUT"===tagName||"TEXTAREA"===tagName||target.isContentEditable)&&(keypressTimeout||domEventHandler("input",handler)(event),clearTimeout(keypressTimeout),keypressTimeout=setTimeout(function(){keypressTimeout=void 0},debounceDuration))}}function instrumentError(){_oldOnErrorHandler=global.onerror;global.onerror=
function(msg,url,line,column,error){triggerHandlers("error",{column:column,error:error,line:line,msg:msg,url:url});return _oldOnErrorHandler?_oldOnErrorHandler.apply(this,arguments):!1}}function instrumentUnhandledRejection(){_oldOnUnhandledRejectionHandler=global.onunhandledrejection;global.onunhandledrejection=function(e){triggerHandlers("unhandledrejection",e);return _oldOnUnhandledRejectionHandler?_oldOnUnhandledRejectionHandler.apply(this,arguments):!0}}Object.defineProperty(exports,"__esModule",
{value:!0});var tslib_1=require("module$node_modules$tslib$tslib"),is_1=require("module$node_modules$$sentry$utils$dist$is"),logger_1=require("module$node_modules$$sentry$utils$dist$logger"),misc_1=require("module$node_modules$$sentry$utils$dist$misc"),object_1=require("module$node_modules$$sentry$utils$dist$object"),supports_1=require("module$node_modules$$sentry$utils$dist$supports");global=misc_1.getGlobalObject();var handlers={},instrumented={};exports.addInstrumentationHandler=function(handler){if(handler&&
"string"===typeof handler.type&&"function"===typeof handler.callback&&(handlers[handler.type]=handlers[handler.type]||[],handlers[handler.type].push(handler.callback),handler=handler.type,!instrumented[handler]))switch(instrumented[handler]=!0,handler){case "console":instrumentConsole();break;case "dom":instrumentDOM();break;case "xhr":instrumentXHR();break;case "fetch":instrumentFetch();break;case "history":instrumentHistory();break;case "error":instrumentError();break;case "unhandledrejection":instrumentUnhandledRejection();
break;default:logger_1.logger.warn("unknown instrumentation type:",handler)}};var lastHref,debounceDuration=1E3,debounceTimer=0,keypressTimeout,lastCapturedEvent,_oldOnErrorHandler=null,_oldOnUnhandledRejectionHandler=null}
//# sourceMappingURL=module$node_modules$$sentry$utils$dist$instrument.js.map
