shadow$provide.module$node_modules$$sentry$hub$dist$scope=function(global$jscomp$0,require,module,exports){function getGlobalEventProcessors(){var global=utils_1.getGlobalObject();global.__SENTRY__=global.__SENTRY__||{};global.__SENTRY__.globalEventProcessors=global.__SENTRY__.globalEventProcessors||[];return global.__SENTRY__.globalEventProcessors}Object.defineProperty(exports,"__esModule",{value:!0});var tslib_1=require("module$node_modules$tslib$tslib"),utils_1=require("module$node_modules$$sentry$utils$dist$index");
global$jscomp$0=function(){function Scope(){this._notifyingListeners=!1;this._scopeListeners=[];this._eventProcessors=[];this._breadcrumbs=[];this._user={};this._tags={};this._extra={};this._contexts={}}Scope.clone=function(scope){var newScope=new Scope;scope&&(newScope._breadcrumbs=tslib_1.__spread(scope._breadcrumbs),newScope._tags=tslib_1.__assign({},scope._tags),newScope._extra=tslib_1.__assign({},scope._extra),newScope._contexts=tslib_1.__assign({},scope._contexts),newScope._user=scope._user,
newScope._level=scope._level,newScope._span=scope._span,newScope._transactionName=scope._transactionName,newScope._fingerprint=scope._fingerprint,newScope._eventProcessors=tslib_1.__spread(scope._eventProcessors));return newScope};Scope.prototype.addScopeListener=function(callback){this._scopeListeners.push(callback)};Scope.prototype.addEventProcessor=function(callback){this._eventProcessors.push(callback);return this};Scope.prototype.setUser=function(user){this._user=user||{};this._notifyScopeListeners();
return this};Scope.prototype.setTags=function(tags){this._tags=tslib_1.__assign(tslib_1.__assign({},this._tags),tags);this._notifyScopeListeners();return this};Scope.prototype.setTag=function(key,value){var _a;this._tags=tslib_1.__assign(tslib_1.__assign({},this._tags),(_a={},_a[key]=value,_a));this._notifyScopeListeners();return this};Scope.prototype.setExtras=function(extras){this._extra=tslib_1.__assign(tslib_1.__assign({},this._extra),extras);this._notifyScopeListeners();return this};Scope.prototype.setExtra=
function(key,extra){var _a;this._extra=tslib_1.__assign(tslib_1.__assign({},this._extra),(_a={},_a[key]=extra,_a));this._notifyScopeListeners();return this};Scope.prototype.setFingerprint=function(fingerprint){this._fingerprint=fingerprint;this._notifyScopeListeners();return this};Scope.prototype.setLevel=function(level){this._level=level;this._notifyScopeListeners();return this};Scope.prototype.setTransactionName=function(name){this._transactionName=name;this._notifyScopeListeners();return this};
Scope.prototype.setTransaction=function(name){return this.setTransactionName(name)};Scope.prototype.setContext=function(key,context){var _a;this._contexts=tslib_1.__assign(tslib_1.__assign({},this._contexts),(_a={},_a[key]=context,_a));this._notifyScopeListeners();return this};Scope.prototype.setSpan=function(span){this._span=span;this._notifyScopeListeners();return this};Scope.prototype.getSpan=function(){return this._span};Scope.prototype.getTransaction=function(){var span=this.getSpan();if(span&&
span.spanRecorder&&span.spanRecorder.spans[0])return span.spanRecorder.spans[0]};Scope.prototype.update=function(captureContext){if(!captureContext)return this;if("function"===typeof captureContext)return captureContext=captureContext(this),captureContext instanceof Scope?captureContext:this;captureContext instanceof Scope?(this._tags=tslib_1.__assign(tslib_1.__assign({},this._tags),captureContext._tags),this._extra=tslib_1.__assign(tslib_1.__assign({},this._extra),captureContext._extra),this._contexts=
tslib_1.__assign(tslib_1.__assign({},this._contexts),captureContext._contexts),captureContext._user&&(this._user=captureContext._user),captureContext._level&&(this._level=captureContext._level),captureContext._fingerprint&&(this._fingerprint=captureContext._fingerprint)):utils_1.isPlainObject(captureContext)&&(this._tags=tslib_1.__assign(tslib_1.__assign({},this._tags),captureContext.tags),this._extra=tslib_1.__assign(tslib_1.__assign({},this._extra),captureContext.extra),this._contexts=tslib_1.__assign(tslib_1.__assign({},
this._contexts),captureContext.contexts),captureContext.user&&(this._user=captureContext.user),captureContext.level&&(this._level=captureContext.level),captureContext.fingerprint&&(this._fingerprint=captureContext.fingerprint));return this};Scope.prototype.clear=function(){this._breadcrumbs=[];this._tags={};this._extra={};this._user={};this._contexts={};this._span=this._fingerprint=this._transactionName=this._level=void 0;this._notifyScopeListeners();return this};Scope.prototype.addBreadcrumb=function(breadcrumb,
maxBreadcrumbs){breadcrumb=tslib_1.__assign({timestamp:utils_1.timestampWithMs()},breadcrumb);this._breadcrumbs=void 0!==maxBreadcrumbs&&0<=maxBreadcrumbs?tslib_1.__spread(this._breadcrumbs,[breadcrumb]).slice(-maxBreadcrumbs):tslib_1.__spread(this._breadcrumbs,[breadcrumb]);this._notifyScopeListeners();return this};Scope.prototype.clearBreadcrumbs=function(){this._breadcrumbs=[];this._notifyScopeListeners();return this};Scope.prototype.applyToEvent=function(event,hint){this._extra&&Object.keys(this._extra).length&&
(event.extra=tslib_1.__assign(tslib_1.__assign({},this._extra),event.extra));this._tags&&Object.keys(this._tags).length&&(event.tags=tslib_1.__assign(tslib_1.__assign({},this._tags),event.tags));this._user&&Object.keys(this._user).length&&(event.user=tslib_1.__assign(tslib_1.__assign({},this._user),event.user));this._contexts&&Object.keys(this._contexts).length&&(event.contexts=tslib_1.__assign(tslib_1.__assign({},this._contexts),event.contexts));this._level&&(event.level=this._level);this._transactionName&&
(event.transaction=this._transactionName);this._span&&(event.contexts=tslib_1.__assign({trace:this._span.getTraceContext()},event.contexts));this._applyFingerprint(event);event.breadcrumbs=tslib_1.__spread(event.breadcrumbs||[],this._breadcrumbs);event.breadcrumbs=0<event.breadcrumbs.length?event.breadcrumbs:void 0;return this._notifyEventProcessors(tslib_1.__spread(getGlobalEventProcessors(),this._eventProcessors),event,hint)};Scope.prototype._notifyEventProcessors=function(processors,event,hint,
index){var _this=this;void 0===index&&(index=0);return new utils_1.SyncPromise(function(resolve,reject){var processor=processors[index];null===event||"function"!==typeof processor?resolve(event):(processor=processor(tslib_1.__assign({},event),hint),utils_1.isThenable(processor)?processor.then(function(final){return _this._notifyEventProcessors(processors,final,hint,index+1).then(resolve)}).then(null,reject):_this._notifyEventProcessors(processors,processor,hint,index+1).then(resolve).then(null,reject))})};
Scope.prototype._notifyScopeListeners=function(){var _this=this;this._notifyingListeners||(this._notifyingListeners=!0,setTimeout(function(){_this._scopeListeners.forEach(function(callback){callback(_this)});_this._notifyingListeners=!1}))};Scope.prototype._applyFingerprint=function(event){event.fingerprint=event.fingerprint?Array.isArray(event.fingerprint)?event.fingerprint:[event.fingerprint]:[];this._fingerprint&&(event.fingerprint=event.fingerprint.concat(this._fingerprint));event.fingerprint&&
!event.fingerprint.length&&delete event.fingerprint};return Scope}();exports.Scope=global$jscomp$0;exports.addGlobalEventProcessor=function(callback){getGlobalEventProcessors().push(callback)}}
//# sourceMappingURL=module$node_modules$$sentry$hub$dist$scope.js.map
